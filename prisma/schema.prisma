generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Entry {
  id        String    @id @default(cuid())
  userId    String
  uploadId  String
  docName   String?

  chunkClean String
  chunkRaw   String

  type    EntryType
  title   String?
  content String?
  tags    String[]

  // Universal metadata field - schema varies by type
  metadata Json?

  confidence Float   @default(0)
  isTemplate Boolean @default(false)
  parseError Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([userId, type])
}

enum EntryType {
  concept     // Definitions, terms, ideas (any field)
  principle   // Laws, rules, heuristics, patterns
  quote       // Memorable statements with attribution
  example     // Concrete instances, cases, worked problems
  procedure   // Step-by-step methods, algorithms
  question    // Problems to solve, things to investigate
  connection  // Analogies, links between ideas
  note        // Freeform observations, reflections
  reference   // Pointers to external sources
  template    // Structural/organizational elements
  unknown     // Fallback
}
